
record(bi, Cryo-Linde-status) {
  field(DTYP, "S7plc stat")
  field(INP, "@Cryo-Linde")
  field(SCAN, "I/O Intr")
  field(ZNAM, "disconnected")
  field(ONAM, "connected")
  field(ZSV, "MAJOR")
  field(FLNK, "Cryo-Linde-status-counter")
}

record(calc, Cryo-Linde-status-counter) {
  field(INPA, "Cryo-Linde-status-counter")
  field(CALC, "A+1")
  field(FLNK, "Cryo-Linde-disconnect-counter")
}

record(calc, s7-send-counter) {
  field(INPA, "s7-send-counter")
  field(CALC, "A+1")
  field(FLNK, "s7-counter-fanout")
}

record(fanout, s7-counter-fanout) {
  field(LNK1, "Cryo-PLC:RES1")
  field(LNK2, "s7-sendErr-counter")
}

record(calc, s7-sendErr-counter) {
  field(INPA, "s7-sendErr-counter")
  field(INPB, "Cryo-Linde-status")
#   field (INPC, "s7-send-counter")
  field(CALC, "B?A:A+1")
  field(FLNK, "Cryo-PLC:RES2")
}

record(calc, Cryo-Linde-disconnect-counter) {
  field(INPA, "Cryo-Linde-status")
  field(INPB, "Cryo-Linde-disconnect-counter.LA")
  field(INPC, "Cryo-Linde-disconnect-counter")
  field(CALC, "(A=0&&B=1)?C+1:C")
}

record(ao, Cryo-PLC:RES1) {
  field(DESC, "Send buffer counter")
  field(DTYP, "S7plc")
  field(OUT, "@Cryo-Linde/0 T=UINT16")
  field(DOL, "s7-send-counter")
  field(OMSL, "closed_loop")
  field(DRVL, "0")
  field(DRVH, "0xFFFF")
  field(PINI, "YES")
}

record(ao, Cryo-PLC:RES2) {
  field(DESC, "Send Error buffer counter")
  field(DTYP, "S7plc")
  field(OUT, "@Cryo-Linde/2 T=UINT16")
  field(DOL, "s7-sendErr-counter")
  field(OMSL, "closed_loop")
  field(DRVL, "0")
  field(DRVH, "0xFFFF")
  field(PINI, "YES")
}

record(waveform, Cryo-PLC:PLCSend:Buffer) {
  field(DTYP, "S7plc")
  field(INP, "@Cryo-Linde/0 T=UINT16")
  field(FTVL, "SHORT")
  field(NELM, "1000")
  field(SCAN, "I/O Intr")
}

record(event, One-second-event) {
  field(DESC, "Trigger for the plot update")
  field(DTYP, "Soft Channel")
  field(SCAN, "1 second")
  field(VAL, "1")
}

# longin record total running times
record(longin, Cryo-Cmp:C1:TotOpTm) {
  field(DESC, "Total Operating Time")
  field(EGU, "h")
  field(DTYP, "S7plc")
  field(INP, "@Cryo-Linde/800 T=INT32")
  field(SCAN, "I/O Intr")
  field (SIMS, "INVALID")
}

record(longin, Cryo-Cmp:C1:ActOpTm) {
  field(DESC, "Total Operating Time since the start")
  field(EGU, "h")
  field(DTYP, "S7plc")
  field(INP, "@Cryo-Linde/804 T=INT32")
  field(SCAN, "I/O Intr")
  field (SIMS, "INVALID")
}
record(stringin, Cryo-Regen:Ads80K:StaInf) {
  field(DTYP, "S7plc")
  field(INP, "@Cryo-Linde/1150 L=32")
  field(SCAN, "I/O Intr")
  field (SIMS, "INVALID")
}


record (ai, "Cryo-CBox:LN2:PDI3685") {
  field (DESC, "Coldbox:LN2 diff pressure")
  field (EGU, "mbar")
  field (PREC, "4")
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/48 T=FLOAT")
  field (SCAN, "I/O Intr")
  field (FLNK, "Cryo-CBox:LN2:LI3685-PercOut")
  field (SIMS, "INVALID")
}

record (calc, "Cryo-CBox:LN2:LI3685-PercOut") {
  field (DESC, "Rec:Coldbox LN2 level")
  field (EGU, "%")
  field (PREC, "4")
  field (INPA, "Cryo-CBox:LN2:PDI3685")
  field (CALC, "100*A/496")
}

record(mbbi, "Cryo-Rec:LP:BalloonLevel") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/11 T=BYTE")
  field (SCAN, "I/O Intr")
  field (NOBT, "4")
  field (ZRVL, "0")
  field (ONVL, "1")
  field (THVL, "3")
  field (SVVL, "7")
  field (FFVL, "15")
  field (ZRST, "Too low")
  field (ONST, "Low")
  field (THST, "Normal")
  field (SVST, "High")
  field (FFST, "Too high")
  field (UNSV, "MINOR")
  field (DESC, "Balloon level Visual State")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-CBox:Ads80K:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/1430 T=BYTE")
  field (SCAN, "I/O Intr") 
  field (NOBT, "8") 
  field (ZRVL, "1")
  field (ONVL, "2")
  field (TWVL, "4")
  field (THVL, "8")
  field (FRVL, "16")
  field (FVVL, "32")
  field (SXVL, "64")
  field (SVVL, "128") 
  field (ZRST, "INIT")
  field (ONST, "PRESSURIZE")
  field (TWST, "COOLDOWN")
  field (THST, "ADSORPTION")
  field (FRST, "PARALLEL")
  field (FVST, "ISOLATION")
  field (SXST, "DEPRESS")
  field (SVST, "MANUAL")
  field (UNSV, "MINOR")
  field (DESC, "Ads80K Visual State")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Cmp:C1:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/612 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")   
  field (ZRST, "OFF") 
  field (ONST, "STARTUP")
  field (TWST, "ON")
  field (THST, "OFF")
  field (FRST, "FAULT")
  field (SIMS, "INVALID")
}
record(mbbi, "Cryo-MCD:MCD:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/632 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")   
  field (ZRST, "Off") 
  field (ONST, "Await pres stabl")
  field (TWST, "Purge")
  field (THST, "Measuring")  
  field (UNSV, "MINOR")
  field (DESC, "MCD visual state")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-HP:DisChrgRec:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/642 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")   
  field (ZRST, "Off")  
  field (ONST, "buffer active")
  field (TWST, "recovery selected")
  field (THST, "recovery on")
  field (FRST, "recovery active")
  field (UNSV, "MINOR")
  field (DESC, "Discharge in")
  field (SIMS, "INVALID")
}
record(mbbi, "Cryo-CBox:CoolMode:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/652 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")   
  field (FVVL, "5")
  field (SXVL, "6")  
  field (ZRST, "Off") 
  field (ONST, "On")
  field (TWST, "Cooldown")
  field (THST, "Liquifying")
  field (FRST, "")  
  field (FVST, "Trip")
  field (FVSV, "MAJOR")
  field (SXST, "LN2 ilk active")
  field (SXSV, "MAJOR")
  field (UNSV, "MINOR")
  field (DESC, "Coolmode visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-CBox:WarmUpMode:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/662 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")  
  field (ZRST, "Off") 
  field (ONST, "On")
  field (TWST, "WU completed")
  field (UNSV, "MINOR")
  field (DESC, "Warm-up mode visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-CBox:LN2:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/672 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")   
  field (ZRST, "Off") 
  field (ONST, "Selected")
  field (TWST, "Cooldown")
  field (THST, "On")
  field (FRST, "Shutdown")
  field (UNSV, "MINOR")
  field (DESC, "LN2 visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-CBox:LN2-IlkTu:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/682 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")   
  field (ZRST, "Off") 
  field (ONST, "Selected")
  field (TWST, "Active")
  field (THST, "Finish")
  field (UNSV, "MINOR")
  field (DESC, "Interlock turbines visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Dwr:Htr:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/692 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")
  field (FVVL, "5")   
  field (ZRST, "Off") 
  field (ONST, "Locked")
  field (TWST, "Selected")
  field (THST, "Level too low")
  field (FRST, "Pressure too high")  
  field (FVST, "Heater on")
  field (UNSV, "MINOR")
  field (DESC, "Dewar heater visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-VacSys:VacSys:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/702 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4")
  field (FVVL, "5")   
  field (ZRST, "Off") 
  field (ONST, "On-pump active")
  field (TWST, "On-pump active")
  field (THST, "On-standby")
  field (FRST, "On-cryo pump")
  field (FVST, "Selected")
  field (UNSV, "MINOR")
  field (DESC, "VacSys visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Pur:Pur:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/712 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4") 
  field (FVVL, "5")
  field (SXVL, "6")
  field (SVVL, "7")
  field (EIVL, "8")  
  field (ZRST, "Off") 
  field (ONST, "Cooldown")
  field (TWST, "Recooling")
  field (THST, "Purge")
  field (FRST, "Standby") 
  field (FVST, "Purify")
  field (SXST, "Regeneration")
  field (SVST, "Alarm")
  field (EIST, "Selected")
  field (SVSV, "MAJOR")
  field (UNSV, "MINOR")
  field (DESC, "Purifier visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Cbox:Tu1:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/684 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4") 
  field (FVVL, "5")
  field (SXVL, "6")
  field (SVVL, "7")
  field (EIVL, "8")  
  field (ZRST, "Off") 
  field (ONST, "Purge")
  field (TWST, "Conditioning")
  field (THST, "Start-up")
  field (FRST, "Run") 
  field (FVST, "Trip")
  field (SXST, "")
  field (SVST, "")
  field (EIST, "")
  field (FVSV, "MAJOR")
  field (UNSV, "MINOR")
  field (DESC, "Tu 1 visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Cbox:Tu2:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/686 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4") 
  field (FVVL, "5")
  field (SXVL, "6")
  field (SVVL, "7")
  field (EIVL, "8")  
  field (ZRST, "Off") 
  field (ONST, "Purge")
  field (TWST, "Conditioning")
  field (THST, "Start-up")
  field (FRST, "Run") 
  field (FVST, "Trip")
  field (SXST, "")
  field (SVST, "")
  field (EIST, "")
  field (FVSV, "MAJOR")
  field (UNSV, "MINOR")
  field (DESC, "Tu 2 visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-ICn:PmsTI5220:VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/714 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ONVL, "1")
  field (TWVL, "2")
  field (THVL, "3")
  field (FRVL, "4") 
  field (FVVL, "5")
  field (SXVL, "6")
  field (SVVL, "7")
  field (EIVL, "8")  
  field (ZRST, "") 
  field (ONST, "")
  field (TWST, "Permissive")
  field (THST, "")
  field (FRST, "") 
  field (FVST, "")
  field (SXST, "")
  field (SVST, "")
  field (EIST, "")
  field (UNSV, "MINOR")
  field (DESC, "PmsTI5220 visual states")
  field (SIMS, "INVALID")
}

record(mbbi, "Cryo-Rec:LP:GasBag_VisuState") {
  field (DTYP, "S7plc")
  field (INP,  "@Cryo-Linde/716 T=INT16")
  field (SCAN, "I/O Intr") 
  field (NOBT, "16") 
  field (ZRVL, "0")
  field (ZRST, "Normal") 
  field (ZRSV, "NO_ALARM") 
  field (ONVL, "4")
  field (ONST, "Empty")
  field (ONSV, "NO_ALARM") 
  field (TWVL, "8")
  field (TWST, "High")
  field (TWSV, "MINOR") 
  field (THVL, "5")
  field (THST, "Flat")
  field (THSV, "MAJOR") 
  field (FRVL, "10") 
  field (FRST, "Full") 
  field (FRSV, "MAJOR") 
  field (UNSV, "MAJOR")
  field (DESC, "Gas bag visual states")
  field (SIMS, "INVALID")
}

record (calc, "Cryo-CBox:Pur:PurOffAlrm-calc") {
  field(INPA, "Cryo-Pur:Pur:SwOnStat")
  field(INPB, "Cryo-CBox:CoolMode:VisuState")
  field(CALC, "(A=0)&&(B#0)?1:0")
  field(SCAN, "1 second")
  field(FLNK, "Cryo-CBox:Pur:PurOffAlrm")
}

record (bi, "Cryo-CBox:Pur:PurOffAlrm") {
  field(DESC, "Alarm: Purifier Off")
  field(INP, "Cryo-CBox:Pur:PurOffAlrm-calc")
  field(ZNAM, "OK")
  field(ONAM, "Purifier Off")
  field(OSV, "MAJOR")
  field (SIMS, "INVALID")
}

record(calc, "Cryo-Cmp:HP:PI2170-Alrm") {
  field (SCAN, "1 second")
  field (DESC,"Alarm: Pur pressure too low")
  field (INPA, "Cryo-Cmp:HP:PI2170.SEVR")
  field (INPB, "Cryo-CBox:CoolMode:VisuState")
  field (INPC, "Cryo-Pur:Pur:VisuState")
  field (LOW, "-0.5")
  field (LOLO, "-1.5")
  field (LSV, "MINOR")
  field (LLSV, "MAJOR")
  field (CALC, "((B=2)||(B=3))&&(C>0)&&(C<7)?-A:0")
}

record(calc, "Cryo-Ctrl:CV:InMan") {
  field (SCAN, "1 second")
  field (DESC,"Warn: Control Valve in Man")
  field (INPA, "Cryo-Ctrl:CV:ManWrn-HLP1")
  field (INPB, "Cryo-Ctrl:CV:ManWrn-HLP2")
  field (INPC, "Cryo-Cmp:LP:UY2250-PercOutsMan")
  field (CALC, "A+B+C")
  field (HIGH, "0.5")
  field (HSV, "MINOR")
}

record(calc, "Cryo-Ctrl:CV:ManWrn-HLP1") {
  field (SCAN, "1 second")
  field (INPA, "Cryo-CBox:Ads80K:UY3114-PercOutsMan")
  field (INPB, "Cryo-CBox:Pur:UY3465-PercOutsMan")
  field (INPC, "Cryo-Dwr:V:UY5202-PercOutsMan")
  field (INPD, "Cryo-Dwr:V:UY5203-PercOutsMan")
  field (INPE, "Cryo-CBox:Pur:UY3401-PercOutsMan")
  field (INPF, "Cryo-CBox:LN2:UY3615-PercOutsMan")
  field (INPG, "Cryo-CBox:Ads80K:UY3117-PercOutsMan")
  field (INPH, "Cryo-Dwr:V:UY5201-PercOutsMan")
  field (INPI, "Cryo-CBox:Pur:UY3420-PercOutsMan")
  field (INPJ, "Cryo-Cmp:HP:SY2110-PercOutsMan")
  field (INPK, "Cryo-CBox:Pur:UY3490-PercOutsMan")
  field (INPL, "Cryo-CBox:HP:UY3170-PercOutsMan")
  field (CALC, "A+B+C+D+E+F+G+H+I+J+K+L")
}
record(calc, "Cryo-Ctrl:CV:ManWrn-HLP2") {
  field (SCAN, "1 second")
  field (INPA, "Cryo-CBox:Ads80K:UY3112-PercOutsMan")
  field (INPB, "Cryo-Pur:Htr:UY3470-PercOutsMan")
  field (INPC, "Cryo-CBox:LP:UY3290-PercOutsMan")
  field (INPD, "Cryo-CBox:HP:UY3151-PercOutsMan")
  field (INPE, "Cryo-CBox:HP:UY3131-PercOutsMan")
  field (INPF, "Cryo-CBox:HP:UY3111-PercOutsMan")
  field (INPG, "Cryo-CBox:HP:UY3160-PercOutsMan")
  field (INPH, "Cryo-CBox:Htr:UY3115-PercOutsMan")
  field (INPI, "Cryo-CBox:HP:UY3130-PercOutsMan")
  field (INPJ, "Cryo-Cmp:HP:UY2150-PercOutsMan")
  field (INPK, "Cryo-Cmp:HP:UY2160-PercOutsMan")
  field (INPL, "Cryo-CBox:Pur:UY3435-PercOutsMan")
  field (CALC, "A+B+C+D+E+F+G+H+I+J+K+L")
}

